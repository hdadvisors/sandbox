{
  "hash": "61a9c947a09b89d737f5b86b29633ceb",
  "result": {
    "markdown": "# mapview\n\nThis page is a demonstration of an interactive mapview map rendered in Quarto.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(mapview)\nlibrary(sf)\nlibrary(tidyverse)\n\n# Load in data (manually downloaded from HUD eGIS site) and select only relevant columns\n\nhud_insured <- read_csv(\"data/chesterfield_hud_insured.csv\") |>  \n  select(1,2,9,10,15,16,18,57,60,74,111,133,140,141)\n\n# Create spatial object using the lat/long coordinate fields\n\nhud_insured_pts <- hud_insured |> \n  st_as_sf(coords = c(\"X\", \"Y\"),\n           crs = 4326) %>%\n  st_transform(6440)\n\n# Create map\n\nmapview(\n  hud_insured_pts,\n  label = \"PROPERTY_NAME_TEXT\",\n  legend = F,\n  popup = F,\n  burst = F,\n  layer.name = \"HUD insured multifamily properties\"\n)\n```\n\n::: {#fig-mapview .cell-output-display}\n```{=html}\n<div id=\"htmlwidget-db10b9c91d36c7ca8103\" style=\"width:100%;height:464px;\" class=\"leaflet html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-db10b9c91d36c7ca8103\">{\"x\":{\"options\":{\"minZoom\":1,\"maxZoom\":52,\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}},\"preferCanvas\":false,\"bounceAtZoomLimits\":false,\"maxBounds\":[[[-90,-370]],[[90,370]]]},\"calls\":[{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB.Positron\",\"CartoDB.Positron\",\"CartoDB.Positron\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB.DarkMatter\",\"CartoDB.DarkMatter\",\"CartoDB.DarkMatter\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"OpenStreetMap\",\"OpenStreetMap\",\"OpenStreetMap\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"Esri.WorldImagery\",\"Esri.WorldImagery\",\"Esri.WorldImagery\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"OpenTopoMap\",\"OpenTopoMap\",\"OpenTopoMap\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"createMapPane\",\"args\":[\"point\",440]},{\"method\":\"addCircleMarkers\",\"args\":[[37.3172209989998,37.3262319989998,37.3582219989998,37.5218999989998,37.3561199989997,37.3584519989998,37.5256059989997,37.4159159989998,37.3452999989998,37.4198999989998,37.5097969989998,37.3878599989999,37.4633369989998,37.3611169989998,37.3442999989997,37.3582219989998,37.3452999989998,37.3452999989998,37.5125999989997],[-77.4099199999999,-77.318479,-77.445748,-77.6383999999999,-77.402102,-77.445726,-77.665657,-77.648419,-77.4372,-77.7730999999999,-77.6633619999999,-77.4274799999999,-77.663779,-77.408168,-77.4904999999999,-77.445748,-77.4372,-77.4372,-77.6251999999999],6,null,\"HUD insured multifamily properties\",{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}},\"pane\":\"point\",\"stroke\":true,\"color\":\"#333333\",\"weight\":1,\"opacity\":0.9,\"fill\":true,\"fillColor\":\"#6666FF\",\"fillOpacity\":0.6},null,null,null,{\"maxWidth\":800,\"minWidth\":50,\"autoPan\":true,\"keepInView\":false,\"closeButton\":true,\"closeOnClick\":true,\"className\":\"\"},[\"Colonial Ridge Apartments\",\"Chesterfield Gardens Apartment\",\"Chester Village Green Apartments\",\"Spring Arbor5-Salisbury\",\"White Oak Apartments\",\"Festival Park Apartments\",\"Spring Arbor Cottage\",\"Auburn Hill at Swift Creek\",\"Moore's Lake Apartments\",\"Magnolia Green Apts.\",\"Midlothian Town Center Apartments\",\"Colony Village Apartments\",\"Abberly at Centerpointe\",\"Moore's Lake Apts -- Phase II\",\"The Reserve at Rivington\",\"The Park at Village Green\",\"The Reserve at Rivington\",\"Greenyard Apartments\",\"Summerfield Senior Apartments\"],{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addScaleBar\",\"args\":[{\"maxWidth\":100,\"metric\":true,\"imperial\":true,\"updateWhenIdle\":true,\"position\":\"bottomleft\"}]},{\"method\":\"addHomeButton\",\"args\":[-77.7730999999999,37.3172209989998,-77.318479,37.5256059989997,true,\"HUD insured multifamily properties\",\"Zoom to HUD insured multifamily properties\",\"<strong> HUD insured multifamily properties <\\/strong>\",\"bottomright\"]},{\"method\":\"addLayersControl\",\"args\":[[\"CartoDB.Positron\",\"CartoDB.DarkMatter\",\"OpenStreetMap\",\"Esri.WorldImagery\",\"OpenTopoMap\"],\"HUD insured multifamily properties\",{\"collapsed\":true,\"autoZIndex\":true,\"position\":\"topleft\"}]}],\"limits\":{\"lat\":[37.3172209989998,37.5256059989997],\"lng\":[-77.7730999999999,-77.318479]},\"fitBounds\":[37.3172209989998,-77.7730999999999,37.5256059989997,-77.318479,[]]},\"evals\":[],\"jsHooks\":{\"render\":[{\"code\":\"function(el, x, data) {\\n  return (\\n      function(el, x, data) {\\n      // get the leaflet map\\n      var map = this; //HTMLWidgets.find('#' + el.id);\\n      // we need a new div element because we have to handle\\n      // the mouseover output separately\\n      // debugger;\\n      function addElement () {\\n      // generate new div Element\\n      var newDiv = $(document.createElement('div'));\\n      // append at end of leaflet htmlwidget container\\n      $(el).append(newDiv);\\n      //provide ID and style\\n      newDiv.addClass('lnlt');\\n      newDiv.css({\\n      'position': 'relative',\\n      'bottomleft':  '0px',\\n      'background-color': 'rgba(255, 255, 255, 0.7)',\\n      'box-shadow': '0 0 2px #bbb',\\n      'background-clip': 'padding-box',\\n      'margin': '0',\\n      'padding-left': '5px',\\n      'color': '#333',\\n      'font': '9px/1.5 \\\"Helvetica Neue\\\", Arial, Helvetica, sans-serif',\\n      'z-index': '700',\\n      });\\n      return newDiv;\\n      }\\n\\n\\n      // check for already existing lnlt class to not duplicate\\n      var lnlt = $(el).find('.lnlt');\\n\\n      if(!lnlt.length) {\\n      lnlt = addElement();\\n\\n      // grab the special div we generated in the beginning\\n      // and put the mousmove output there\\n\\n      map.on('mousemove', function (e) {\\n      if (e.originalEvent.ctrlKey) {\\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\\n      lnlt.text(\\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\\n                           ' | zoom: ' + map.getZoom() +\\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\\n                           ' | epsg: 3857 ' +\\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\\n      } else {\\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\\n      lnlt.text(\\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\\n                      ' | zoom: ' + map.getZoom() + ' ');\\n      }\\n      });\\n\\n      // remove the lnlt div when mouse leaves map\\n      map.on('mouseout', function (e) {\\n      var strip = document.querySelector('.lnlt');\\n      if( strip !==null) strip.remove();\\n      });\\n\\n      };\\n\\n      //$(el).keypress(67, function(e) {\\n      map.on('preclick', function(e) {\\n      if (e.originalEvent.ctrlKey) {\\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\\n      lnlt.text(\\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\\n                      ' | zoom: ' + map.getZoom() + ' ');\\n      var txt = document.querySelector('.lnlt').textContent;\\n      console.log(txt);\\n      //txt.innerText.focus();\\n      //txt.select();\\n      setClipboardText('\\\"' + txt + '\\\"');\\n      }\\n      });\\n\\n      }\\n      ).call(this.getMap(), el, x, data);\\n}\",\"data\":null},{\"code\":\"function(el, x, data) {\\n  return (function(el,x,data){\\n           var map = this;\\n\\n           map.on('keypress', function(e) {\\n               console.log(e.originalEvent.code);\\n               var key = e.originalEvent.code;\\n               if (key === 'KeyE') {\\n                   var bb = this.getBounds();\\n                   var txt = JSON.stringify(bb);\\n                   console.log(txt);\\n\\n                   setClipboardText('\\\\'' + txt + '\\\\'');\\n               }\\n           })\\n        }).call(this.getMap(), el, x, data);\\n}\",\"data\":null}]}}</script>\n```\n\n\nHUD insured multifamily properties\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/htmlwidgets-1.5.4/htmlwidgets.js\"></script>\r\n<script src=\"site_libs/jquery-1.12.4/jquery.min.js\"></script>\r\n<link href=\"site_libs/leaflet-1.3.1/leaflet.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/leaflet-1.3.1/leaflet.js\"></script>\r\n<link href=\"site_libs/leafletfix-1.0.0/leafletfix.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/proj4-2.6.2/proj4.min.js\"></script>\r\n<script src=\"site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js\"></script>\r\n<link href=\"site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/leaflet-binding-2.1.1/leaflet.js\"></script>\r\n<script src=\"site_libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js\"></script>\r\n<script src=\"site_libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js\"></script>\r\n<link href=\"site_libs/HomeButton-0.0.1/home-button.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/HomeButton-0.0.1/home-button.js\"></script>\r\n<script src=\"site_libs/HomeButton-0.0.1/easy-button-src.min.js\"></script>\r\n<script src=\"site_libs/clipboard-0.0.1/setClipboardText.js\"></script>\r\n<link href=\"site_libs/mapviewCSS-0.0.1/mapview-popup.css\" rel=\"stylesheet\" />\r\n<link href=\"site_libs/mapviewCSS-0.0.1/mapview.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}